{"version":3,"sources":["meteor://ðŸ’»app/client/templates/dashboard/dashboard.js"],"names":[],"mappings":"YAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G","file":"/client/templates/dashboard/dashboard.js","sourcesContent":["\nTemplate.dashboard.rendered = function() {\n\n};\nTemplate.dashboard.created = function() {\n    this.data.search = new ReactiveVar(undefined);\n};\nlet dep = new Tracker.Dependency();\n\nTemplate.dashboard.events({\n  \"submit .add-item\": function (e) {\n\n    // Prevent default button click behavior\n    e.preventDefault();\n\n    // Insert the form data into the \"Items\" collection\n    Meetings.insert({\n      name: $(\"[name='name']\").val(),\n      cost: $(\"[name='cost']\").val() || 1.00,\n      lat: $(\"[name='lat']\").val(),\n      lng: $(\"[name='lng']\").val(),\n      owner: Meteor.userId()\n    });\n\n    // Hide the bootstrap modal once we submit the form\n    $('#addItemModal').modal('hide');\n  },\n  \"change #course-search, keyup #course-search\": function(e) {\n    //console.log(\"change\");\n    if(this.search === undefined) {\n      this.search = new ReactiveVar(\"\");\n    }\n    this.search.set(e.target.value);\n  //  console.log(this.search.get());\n  }\n\n});\n\nTemplate.dashboard.helpers({\n  exampleMapOptions: function() {\n    // Make sure the maps API has loaded\n    if (GoogleMaps.loaded()) {\n      // Map initialization options\n      return {\n        center: new google.maps.LatLng(33.7683, -118.1956),\n        zoom: 8\n      };\n\n    }\n  }\n});\nTemplate.dashboard.helpers({\n  myMeetings: function() {\n    return Meetings.find({owner: Meteor.userId()});\n  },\n  otherMeetings: function() {\n    //console.log(\"other\");\n    if(!this.search.get()) {\n      return Meetings.find();\n    }\n    var regex = new RegExp([this.search.get()].join(\"\"), \"i\");\n    //console.log(regex);\n    return Meetings.find({name: regex});\n  },\n  matches: function(str) {\n    dep.depend();\n    //console.log(\"Search term: \"+searchTerm);\n    var regex = new RegExp([\"/\", this.search.get() || \"/\"].join(\"\"), \"i\");\n    //console.log(regex);\n\n    return !searchTerm || str.match(regex);\n  }\n});\n\n\nTemplate.dashboard.onCreated(function() {\n  // We can use the `ready` callback to interact with the map API once the map is ready.\n  GoogleMaps.ready('exampleMap', function(map) {\n\nvar markers = {};\n\nMeetings.find().observe({  \n  added: function(document) {\n    // Create a marker for this document\n    var lat = document.lat;\n    var lng = document.lng;\n    if(lat && lng) {\n      var marker = new google.maps.Marker({\n        draggable: document.owner == Meteor.userId(),\n        animation: google.maps.Animation.DROP,\n        position: new google.maps.LatLng(lat, lng),\n        map: map.instance,\n        // We store the document _id on the marker in order \n        // to update the document within the 'dragend' event below.\n        id: document._id\n      });\n\n\n      // This listener lets us drag markers on the map and update their corresponding document.\n      google.maps.event.addListener(marker, 'dragend', function(event) {\n        Meetings.update(marker.id, { $set: { lat: event.latLng.lat(), lng: event.latLng.lng() }});\n      });\n      if(document._id) {\n      // Store this marker instance within the markers object.\n        markers[document._id] = marker;\n      } else {\n        console.log(\"no document _id??\");\n      }\n    }\n  },\n  changed: function(newDocument, oldDocument) {\n    if(markers[newDocument._id]) {\n      markers[newDocument._id].setPosition({ lat: newDocument.lat, lng: newDocument.lng });\n    }\n  },\n  removed: function(oldDocument) {\n  \n    console.log(oldDocument);\n    markers[oldDocument._id].setMap(null);\n\n    // Clear the event listener\n    google.maps.event.clearInstanceListeners(\n      markers[oldDocument._id]);\n\n    // Remove the reference to this marker instance\n    delete markers[oldDocument._id];\n  }\n});\n\n    $(\"[name='lat']\").val(map.options.center.lat()+Math.random()-0.5);\n    $(\"[name='lng']\").val(map.options.center.lng()+Math.random()-0.5);\n    //console.log(map.options.center);\n    for(let i = 0; false && i < 10; i++) {\n      setTimeout(function() {\n        let position = new google.maps.LatLng(map.options.center.lat()+Math.random()-0.5, map.options.center.lng()+Math.random()-0.5);\n        let marker = new google.maps.Marker({\n              draggable: true,\n              animation: google.maps.Animation.DROP,\n              position: position,\n              map: map.instance,\n              // We store the document _id on the marker in order \n              // to update the document within the 'dragend' event below.\n              id: i\n            });\n      }, 50*i);\n    }\n  });\n\n});"]}